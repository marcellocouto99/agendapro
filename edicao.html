<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Editar Agendamentos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="menu.css">
    <link rel="stylesheet" href="edicao.css">
</head>
<body>
    <!-- Logo -->
    <div class="logo"> 
        <img src="img/LogoPitstop.png" 
            alt="Logo" 
            style="margin-top: 20px; display: block; margin-left: auto; margin-right: auto;" 
            width="200" height="200">
    </div>  

    <!-- Títulos -->
    <h1 class="titulo">Editar Agendamentos</h1>
    <h6 class="subtitulo">Gerencie, altere ou exclua seus agendamentos</h6>

    <!-- Container Principal -->
    <div class="container mt-4">
        <!-- Campo de busca -->
        <div class="search-section">
            <input type="text" id="searchInput" placeholder="Buscar por nome, placa ou loja">
            <button id="searchButton">Buscar</button>
        </div>

        <!-- Tabela de agendamentos -->
        <table id="appointmentsTable">
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>Placa</th>
                    <th>Loja</th>
                    <th>Data</th>
                    <th>Hora</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                <!-- Linhas serão geradas pelo JS -->
            </tbody>
        </table>
    </div>

    <!-- Modal de Edição -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Editar Agendamento</h2>
            <form id="editForm">
                <div class="form-group">
                    <label for="editName">Nome</label>
                    <input type="text" id="editName" name="name" required>
                </div>
                <div class="form-group">
                    <label for="editPlate">Placa</label>
                    <input type="text" id="editPlate" name="plate" required>
                </div>
                <div class="form-group">
                    <label for="editStore">Loja</label>
                    <input type="text" id="editStore" name="store" required>
                </div>
                <div class="form-group">
                    <label for="editDate">Data</label>
                    <input type="date" id="editDate" name="date" required>
                </div>
                <div class="form-group">
                    <label for="editTime">Hora</label>
                    <input type="time" id="editTime" name="time" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="save-btn">Salvar</button>
                    <button type="button" class="cancel-btn">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Menu Lateral -->
    <nav class="menu-lateral">
        <div class="btn-expandir">
            <i class="bi bi-list" id="btn-exp"></i>
        </div>
        <ul>
            <li class="item-menu">
                <a href="calendario.html">
                    <span class="icon"><i class="bi bi-calendar3"></i></span>
                    <span class="txt-link">Calendário</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="agendamentos.html">
                    <span class="icon"><i class="bi bi-file-earmark-check"></i></span>
                    <span class="txt-link">Agendamento</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="configuracao.html">
                    <span class="icon"><i class="bi bi-gear"></i></span>
                    <span class="txt-link">Configuração</span>
                </a>
            </li>
            <li class="item-menu ativo">
                <a href="edicao.html">
                    <span class="icon"><i class="bi bi-pencil-square"></i></span>
                    <span class="txt-link">Editar</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="#">
                    <span class="icon"><i class="bi bi-person-circle"></i></span>
                    <span class="txt-link">Conta</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="#" id="logoutBtn">
                    <span class="icon"><i class="bi bi-box-arrow-right"></i></span>
                    <span class="txt-link">Sair</span>
                </a>
            </li>
            <li class="logo-item">
                <span class="icon">
                    <img src="img/LogoAgendaPro.png" alt="Logo AgendaPro" class="logo-agendapro">
                </span>
                <span class="logo-text">AgendaPro</span>
            </li>
        </ul>
    </nav>

    <!-- Firebase + Logout -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
      import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyBihcx1ihMSs7egInoGOzV1mWIw9D8LUzw",
        authDomain: "agendapro-f6ecc.firebaseapp.com",
        projectId: "agendapro-f6ecc",
        storageBucket: "agendapro-f6ecc.firebasestorage.app",
        messagingSenderId: "1045418539073",
        appId: "1:1045418539073:web:aa920e129ece148c0feec0"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      // Protege a página
      onAuthStateChanged(auth, (user) => {
        if (!user) {
          window.location.href = "index.html";
        }
      });

      // botão de logout
const logoutBtn = document.getElementById("logoutBtn");
logoutBtn.addEventListener("click", async (e) => {
  e.preventDefault();

  const confirmar = confirm("Tem certeza que deseja sair da conta?");
  if (!confirmar) return; // cancela se clicar em "Cancelar"

  try {
    await signOut(auth);
    alert("Você saiu da conta!");
    window.location.href = "index.html";
  } catch (error) {
    console.error("Erro ao sair:", error);
    alert("Erro ao sair: " + error.message);
  }
});

    </script>

    <script src="edicao.js"></script>
    <script src="menu.js"></script>
</body>
</html>
